```index

```

```tag

```

```summary

```

# 问卷导出和导入

左侧`问卷组件工具栏`下方有个导出导入图标，鼠标覆盖后会出现`导入问卷`、`导出问卷`、`导出选中节点`三个按钮。问卷的导出导入可以方便用户重复使用问卷内容。

> 除了导入导出文件的方式外，也可以使用[组和模块](../groups/concept.md)的功能达到相同的效果。区别是，文件方式可以输出到本地存储，组和模块则保存在云端系统。

## 导出问卷
将问卷设计保存为文件并保存到电脑上，当需要使用时再导入这个文件就可以了。问卷设计导出文件扩展名为：`cfpd`，是本系统专用的加密压缩格式文件。

导出问卷分以下2种情况：
+ 导出完整问卷：点击`导出问卷`按钮，会将当前问卷全部导出到一个文件，并保存到本地。
+ 导出部分问卷：点击`导出选中节点`按钮，会将选中的节点导出到一个文件，并保存到本地。导出部分问卷时，节点中依赖的变量，媒体资源等都会跟着被导出，但是无论选中的节点是否通过变量等形式使用到没有被选中的节点的任何属性，这些未选中节点都不会被连带着导出。

## 导入问卷
导入问卷指打开一份本地问卷文本文件，并使用问卷文件里的内容。支持`cfpd`和`docx`两种格式的文件。
+ `cfpd`格式：巧思系统专有格式；
+ `docx`格式：问卷文本文件；
  
  `问卷文本文件`是指按照指定格式编辑的Word文档`docx`文件，可以使用任何文本编辑软件编写和输出，当文本问卷开头包含了问卷标题和问卷描述时，代表这是一份完整导入模式，导入时会按完整导入模式覆盖当前问卷内容；否则就是部分导入模式，导入时会添加到当前问卷内容里。可以实现脱离问卷编辑器快速创建简单问卷的目的。

点击`导入文件`按钮，选择文件后确认导入，即可完成导入问卷操作。导入问卷后会有以下2种情况：
+ 导入完整问卷：创建和导入问卷相同的问卷内容，如果当前问卷已有内容，则当前内容被会导入问卷的内容覆盖；
+ 导入部分问卷：创建和导入问卷相同的问卷内容，导入的内容会附加到当前问卷中；
> 直接将文件拖拽到问卷编辑器的画布上，按屏幕提示释放文件，等同于导入问卷文件。

## 问卷文本文件格式
`问卷文本文件`要求按格式规范编写文档内容，格式要求：
+ 第一行有效文本会被作为问卷标题，其后的多行有效文本会被作为问卷描述，直到发现方括号`[]`包裹的题型名称。
+ 当发现方括号`[]`包裹的题型名称后，其后内容则为问卷的题目和选项。
+ 方括号`[]`必须为半角英文符号，中文`【】`不会别识别。
+ 添加题目时，用`[]`开头，并在`[]`内填入题型名称，后面接题目内容；回车后输入选项，每个选项占据一行。
    > 参考形式：
     ```
        [选择题]选择题样板
        选项1
        选项2
        选项3
     ```

+ 矩阵题的的所有列选项文字在同一行中，`英文空格`分割。
    > 参考形式：
     ```
        [矩阵题]矩阵题样板
        列1 列2 列3 列4
        行1
        行2
        行3
        行4
     ```
 
下面是一份完整的docx文本问卷内容：

```text
    导入问卷样板问卷标题

    导入问卷样板问卷描述第一行
    导入问卷样板问卷描述第二行


    [描述节点]描述节点样板:这个模板开头设置了问卷标题和问卷描述,将会以完整导入的方式导入,即原问卷中的内容会被移除,导入部分成为新的问卷内容.

    [选择题]选择题样板
    选项1
    选项2
    选项3

    [打分题]打分题样板
    打分项1
    打分项2
    打分项3

    [演示评价题]演示评价题样板
    评价项1
    评价项2
    评价项3

    [权重题]权重题样板
    权重项1
    权重项2
    权重项3

    [填空题]填空题样板
    填空1
    填空2
    填空3

    [排序题]排序题样板
    排序项1
    排序项2
    排序项3

    [菜单题]菜单题样板
    菜单项1
    菜单项2
    菜单项3


    [上传题]上传题样板
    上传项1
    上传项2
    上传项3

    [图片选择题]图片选择题样板
    图片1
    图片2
    图片3


    [图标题]图标题样板
    图标1
    图标2
    图标3

    [定位题]定位题样板

    [范围定位题]范围定位题样板

    [矩阵题]矩阵题样板
    列1 列2 列3 列4
    行1
    行2
    行3
    行4

    [结束]结束节点样板

```

只有下列部分题型可以被快速导入：
+ 选择题、打分题、演示评价题、权重题、填空题、排序题、菜单题、上传题、图片选择题、图标题、定位题、范围定位题、矩阵题。
