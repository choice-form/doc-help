# 内置系统变量
> 也叫系统变量或内置变量

内置变量是系统事先定以后的一些变量，在[变量选择器]中处于`系统变量`组内。

包含以下几类：

## 基本类
+ 问卷id：当前这份问卷的问卷id
+ 微信id：受访者的微信id，需要问卷设置微信授权，否则会解析不到值。预览状态下解析不到值。
+ 微信联合id：受访者微信联合id，需要问卷设置微信授权，否则会解析不到值。预览状态下解析不到值。
+ 微信昵称：受访者微信昵称，需要问卷设置微信授权，否则会解析不到值。预览状态下解析不到值。
+ 回复id：受访者下载问卷时生成的一个唯一id。预览状态下解析不到值。
+ 收集器代码：问卷发布的收集器的代码。预览状态下解析不到值。
+ 收集器名称：问卷发布的收集器的名称。预览状态下解析不到值。
+ 开始时间：受访者开始答题的时间。
+ 消耗时间：受访者回答当前进度时所消耗的时间。
+ 结果：受访者回答到当前进度时所有的作答内容。

## 日期类
里面提供了一大堆日期相关的变量，可顾名思义，不一一解说。

## 定位类

+ 坐标：定位点所在的经纬度代码。
+ 国家：定位点所在的国家。
+ 省份：定位点所在的省
+ 城市：定位点所在的市
+ 区县：定位点所在的区或县

## 上下文
提供了一些答题页中某个时间点运行瞬间的状态变量。

+ 选项文字：运行瞬间当前选项的文字。
+ 选项备注：运行瞬间当前选项的备注内容。
+ 选项编号：运行瞬间当前选项的编号。
+ 选项分值：运行瞬间当前选项的分值或输入值。
+ 外层循环文字：运行瞬间当前外层循环变量的文字。
+ 外层循环索引：运行瞬间当前外层循环变量的索引。
+ 外层循环编号：运行瞬间当前外层循环变量的编号。
+ 外层循环分值：运行瞬间当前外层循环变量的分值。
+ 外层循环备注：运行瞬间当前外层循环变量的备注。
+ 内层循环文字：运行瞬间当前内层循环变量的文字。
+ 内层循环索引：运行瞬间当前内层循环变量的索引。
+ 内层循环编号：运行瞬间当前内层循环变量的编号。
+ 内层循环分值：运行瞬间当前内层循环变量的分值。
+ 内层循环备注：运行瞬间当前内层循环变量的备注。

这种上下文变量主要使用在那些创建时不知道是使用在哪里，只有运行时才知道在哪里的变量中。

一般在接口请求变量和选项的的高级设置中使用的最多。

比如说，现在有一道题目有很多个选项（比如100个），需要对这些选项进行[显示控制](../logic/opt-display.md)，控制的规则比较复杂：需要用到之前一个题目的作答内容和当前选项的文字作为条件，然后经过一些计算决定这个选项应不应该显示，所以我们需要创建一个接口请求变量，参数就是之前那个题目作答的内容和当前选项的文字，当我们在这个接口请求变量中设置参数时，之前题目的作答内容很好设置，直接从该节点引用变量即可，但是当前选项的文字就不好设置了，因为这么多选项，不知道设置那个值好，如果对每个选项都设置固定的文字即该选项的文字，这样我们要创建100个这样的接口请求变量，然后在[逻辑编辑器](../logic/logic-editor)中为每个选项设置逻辑条件时都引用和自己对应的那个接口请求变量，这样做虽然能达到效果，但是工作量简直要让人疯狂，如果再添加选项的话，还得同步添加对应的接口请求变量，非常的麻烦，很容易出错。

这时候在设置选项文字参数的地方直接使用`上下文选项文字`变量就能轻松解决该问题，这时候这样设置一个这样的接口请求变量即可，所有的选项都用该变量做为逻辑条件，当对某个选项进行逻辑判断的瞬间运行时的选项就是这个选项，所以`上下文选项文字`就能正确被解析为这个选项的选项文字。

在比如说，上面这个例子的题目是在循环圈中，接口请求变量的参数也要加上当前循环圈的循环变量，这时在这个请求变量的设置面板中也是无法访问直接到目标循环变量的，因为循环变量的只能在目标节点的循环圈内节点才能访问到，这时候就可以使用`上下文外层循环文字`变量就可以，当循环运行到第N圈时，
这个变量就会取到这一瞬间运行时的循环变量文字。


上述两个列子也正好解释了为什么会存在上下文变量这个东西，虽然变量是用来解决动态值的问题的，但是有些场合动态用法常规的变量还是无法做到。

上面的那个接口请求变量，创建这个变量的时候，是不知道他会被用到哪里的，可能被用到各个节点中，所以某些无固定来源的参数变量（如上面的选项文字）这时候没法设置死的，所以要引入`上下文`变量的概念，使用了上下文变量后，以后无论这个接口请求变量被用到那个节点中，只要他运行的瞬间有目标选项，就能该选项的文字，用于A节点的第一个选项，就能取到A节点第一个选项的文字，用于B节点的第三个选项，就能取到B节点的第三个选项的文字；关于循环的山下文变量也是一样的道理。

在设计问卷时，上下文变量在任何地方都能被访问到，就意味着你能在任何地方使用这些变量，但是这些变量能不能解析到值就不一定了，比如在一个题的问题文字中引用上面的接口请求变量的话，因为问题文字生成的瞬间是没有运行时的选项的，所有选项文字这个参数就会为空，导致接口的代码运行不正确，解析不到结果。

在使用上下文变量的时候，确保你自己理解了它的工作机制，

## URL参数
答题页面的URL后面可以携带20个可解析的参数，多余的参数不会被解析。

这些参数的名字必须是key1，key2，key3... 一直到key20。

这些参数被解析后分别可以被URL参数组下面的对应key名的变量引用到。

案列：设计了一份员工调查问卷，该问卷发布后的原始地址是:https://q.choiceform.com?vG3y7W，

分发给每个员工的答题地址是原始地址加上对应员工的工号：https://q.choiceform.com?vG3y7W&key1=number。

这样在问卷中引用URL参数的`key1`变量，就能引用到该员工的工号。

如果引用了某个URL参数变量，但是URL中没有携带这个参数，则引用不到任何内容。
> url中拼接参数是key1参数较为特别，可以简写为key，其它的则后面必须携带对应的数字。